# BLE HID鼠标设备切换功能说明

## 功能概述

该功能允许小智体感鼠标在三种不同的模式之间切换，每种模式模拟为一个独立的蓝牙设备，从而实现在电脑、手机和平板之间的无缝切换。

## 技术实现

### 1. 设备识别差异化
为了让主机设备将不同模式识别为不同的蓝牙设备，每个模式都有独特的：

- **设备名称**: 
  - PC模式: `XiaoZhi-Mouse-PC`
  - 手机模式: `XiaoZhi-Mouse-Phone`  
  - 平板模式: `XiaoZhi-Mouse-Tablet`

- **MAC地址**:
  - PC模式: 使用WiFi STA MAC地址 (`ESP_MAC_WIFI_STA`)
  - 手机模式: 使用WiFi SoftAP MAC地址 (`ESP_MAC_WIFI_SOFTAP`)
  - 平板模式: 使用蓝牙MAC地址 (`ESP_MAC_BT`)

- **服务UUID**:
  - PC模式: `...00:01` (最后一字节为01)
  - 手机模式: `...00:02` (最后一字节为02)  
  - 平板模式: `...00:03` (最后一字节为03)

### 2. 模式切换流程
1. 停止当前蓝牙服务
2. 更新设备配置（名称、MAC、UUID）
3. 重新启动蓝牙服务
4. 开始新模式的广播

## MCP控制命令

### 切换到不同模式
```json
{
  "method": "tools/call",
  "params": {
    "name": "self.ble_mouse.switch_to_pc_mode"
  }
}
```

```json
{
  "method": "tools/call", 
  "params": {
    "name": "self.ble_mouse.switch_to_phone_mode"
  }
}
```

```json
{
  "method": "tools/call",
  "params": {
    "name": "self.ble_mouse.switch_to_tablet_mode"
  }
}
```

### 查询当前模式
```json
{
  "method": "tools/call",
  "params": {
    "name": "self.ble_mouse.get_current_mode"
  }
}
```

## 语音控制示例

用户可以通过语音命令控制模式切换：
- "小智，切换鼠标为电脑模式"
- "小智，切换鼠标为手机模式"
- "小智，切换鼠标为平板模式"
- "小智，当前鼠标是什么模式？"

## 使用场景

1. **工作环境**: 在电脑和平板之间快速切换进行不同的工作任务
2. **多设备协作**: 同时使用手机、平板和电脑，通过语音快速切换控制对象
3. **演示场景**: 在演示过程中无缝切换不同设备的控制

## 注意事项

1. **连接状态**: 切换模式时会断开当前连接，需要重新配对
2. **配对管理**: 主机设备会将不同模式视为不同设备，需要分别配对
3. **模式记忆**: 设备会记住最后使用的模式，重启后保持该模式
4. **性能影响**: 模式切换需要几秒钟时间完成蓝牙服务重启

## 技术特点

- ✅ 完全硬件级别的设备区分
- ✅ 真正的多设备无缝切换
- ✅ 支持语音控制切换
- ✅ 保持所有原有功能（灵敏度调节、滚轮控制等）
- ✅ 兼容现有的MCP架构
